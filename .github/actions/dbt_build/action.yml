
name: dbt build in venv
description: Runs dbt build from venv
inputs:
  env-file:
    required: true
    description: Environment file to source
runs:
  using: composite
  steps:
    - name: dbt build for ${{ inputs.env-file }}
      shell: bash
      run: |
          source .venv/bin/activate
          source ${{ inputs.env-file }}
          dbt deps
          dbt debug
          dbt run
          echo "dbt test goes here"
    - name: upload target artifacts
      uses: actions/upload-artifact@v3
        with:
          name: dbt_target_directory
          path: target
    - name: upload log artifacts
      uses: actions/upload-artifact@v3
        with:
          name: dbt_log_directory
          path: logs


